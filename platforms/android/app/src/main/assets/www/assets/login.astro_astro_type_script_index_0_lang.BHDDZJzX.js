const s=document.getElementById("matricula"),o=document.getElementById("userType"),t=document.getElementById("matriculaHint");function l(r){return!r||!o?(o&&(o.value=""),t&&(t.textContent="El sistema detectará automáticamente si eres alumno o maestro",t.className="mt-1 text-xs text-gray-500"),null):/^[0-9]{8}$/.test(r)?(o.value="alumno",t&&(t.textContent="✓ Detectado: Alumno (8 números)",t.className="mt-1 text-xs text-green-600 font-medium"),"alumno"):/^[A-Za-z0-9]{4}$/.test(r)?(o.value="maestro",t&&(t.textContent="✓ Detectado: Maestro (4 caracteres)",t.className="mt-1 text-xs text-blue-600 font-medium"),"maestro"):/^[0-9]*$/.test(r)&&r.length<8?(o.value="",t&&(t.textContent="Ingresando matrícula de alumno (8 números requeridos)",t.className="mt-1 text-xs text-gray-500"),null):/^[A-Za-z0-9]*$/.test(r)&&r.length<4&&r.length>0?(o.value="",t&&(t.textContent="Ingresando matrícula de maestro (4 caracteres requeridos)",t.className="mt-1 text-xs text-gray-500"),null):(o.value="",t&&(t.textContent="Formato inválido. Use 8 números (alumno) o 4 caracteres (maestro)",t.className="mt-1 text-xs text-red-500"),null)}s&&s.addEventListener("input",r=>{const a=r.target;if(!a)return;let e=a.value.trim();/^[0-9]/.test(e)||/^[0-9]*$/.test(e)&&e.length>0?(e=e.replace(/[^0-9]/g,""),e=e.slice(0,8),a.value=e):(e=e.replace(/[^A-Za-z0-9]/g,""),e=e.slice(0,4).toUpperCase(),a.value=e),l(e)});const c={alumno:{matricula:"10011001",password:"123"},maestro:{matricula:"1001",password:"123"}},u=document.querySelector("form");u&&u.addEventListener("submit",r=>{if(r.preventDefault(),!s)return;const a=s.value.trim(),e=document.getElementById("password");if(!e)return;const i=e.value,n=l(a);if(!n)return a.length===0?alert("Por favor, ingresa tu matrícula"):/^[0-9]*$/.test(a)&&a.length<8?alert("La matrícula de alumno debe tener exactamente 8 números"):/^[A-Za-z0-9]*$/.test(a)&&a.length<4?alert("La matrícula de maestro debe tener exactamente 4 caracteres"):alert("Formato de matrícula inválido. Use 8 números (alumno) o 4 caracteres alfanuméricos (maestro)"),s.focus(),!1;if(n==="alumno"&&!/^[0-9]{8}$/.test(a))return alert("La matrícula de alumno debe tener exactamente 8 números"),s.focus(),!1;if(n==="maestro"&&!/^[A-Za-z0-9]{4}$/.test(a))return alert("La matrícula de maestro debe tener exactamente 4 caracteres alfanuméricos"),s.focus(),!1;if(n!=="alumno"&&n!=="maestro")return;const m=c[n];a===m.matricula&&i===m.password?(sessionStorage.setItem("usuario",JSON.stringify({tipo:n,matricula:a})),n==="alumno"?window.location.href="../alumno/formulario/index.html":n==="maestro"&&(window.location.href="../maestro/dashboard/index.html")):(alert("Matrícula o contraseña incorrectas"),e&&(e.value="",e.focus()))});s&&s.addEventListener("paste",()=>{setTimeout(()=>{if(s){const r=s.value.trim();l(r)}},10)});
